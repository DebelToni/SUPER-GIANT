from google.colab import drive
drive.mount('/content/drive')

%cd drive/MyDrive/SUPER-GIANT/v1/model

!pip install --upgrade "jax[cuda12]" flax

!pip install -U "datasets>=2.19.1" "fsspec" --quiet

import os, pathlib, tempfile
SCRATCH = "/content/.hf_cache"          
pathlib.Path(SCRATCH).mkdir(parents=True, exist_ok=True)
os.environ["HF_HOME"]           = SCRATCH
os.environ["HF_DATASETS_CACHE"] = f"{SCRATCH}/datasets"
os.environ["HF_HUB_CACHE"]      = f"{SCRATCH}/hub"

print("HF caches â†’", SCRATCH)

!git pull

import os
os.environ["XLA_PYTHON_CLIENT_PREALLOCATE"] = "false"   # on-demand alloc
os.environ["XLA_PYTHON_CLIENT_MEM_FRACTION"] = "0.80"   # keep 20 % slack

!python Run_training.py
